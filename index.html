<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dog Attendance / Payments</title>
<style>
  body {font-family: Arial, sans-serif; padding: 20px; background: #f7fafc;}
  .container {max-width: 1200px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.06); overflow-x:auto;}
  h1 {margin-bottom: 12px;}
  .date-controls {display: flex; align-items: center; gap: 10px; margin-bottom: 18px;}
  .date-btn, .date-nav {padding: 10px 18px; font-size: 16px; cursor: pointer;}
  .dog-buttons {display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; margin-bottom: 18px;}
  .dog-buttons button {padding: 8px 14px; cursor: pointer; border-radius: 8px; border: 1px solid #888; background: #e2e8f0;}
  .dog-buttons button.active {background: #2b6cb0; color: #fff;}
  .dropdown {position: relative; display: inline-block;}
  .dropdown-content {display: none; position: absolute; background-color: #f9f9f9; min-width: 120px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; border-radius: 8px;}
  .dropdown-content button {width: 100%; text-align: left; border: none; background: none; padding: 8px 12px; cursor: pointer;}
  .dropdown:hover .dropdown-content {display: block;}
  table {width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; min-width: 1200px;}
  th, td {padding: 8px; border: 1px solid #ddd; text-align: right;}
  th {background: #f1f5f9; text-align: left;}
  td.currency {white-space: nowrap;}
  .weekend {background-color: #fff3e0;}
</style>
</head>
<body>
<div class="container">
  <h1>Dog Attendance / Payments</h1>

  <div class="date-controls">
    <button id="prevDay" class="date-nav">&lt;</button>
    <button id="dateBtn" class="date-btn"></button>
    <button id="nextDay" class="date-nav">&gt;</button>
    <input type="date" id="dateInput" style="display:none; margin-left:10px;" />
  </div>

  <div class="dog-buttons" id="dogButtons"></div>

  <div class="dropdown">
    <button>Extras ▼</button>
    <div class="dropdown-content" id="extrasButtons"></div>
  </div>

  <table id="paymentTable">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Total</th>
        <th>PABLO</th>
        <th>LILI</th>
        <th>JUGNIA</th>
        <th>LEO</th>
        <th>INDIA</th>
        <th>CHUFI</th>
        <th>CUSCO</th>
        <th>KIMCHI</th>
        <th>NINA</th>
        <th>CARMELA</th>
        <th>LUPE</th>
        <th>CUATRI</th>
        <th>TB</th>
        <th>NEO</th>
        <th>BRISO</th>
        <th>ZOZI</th>
        <th>R&H</th>
      </tr>
    </thead>
    <tbody id="tableBody">
    </tbody>
  </table>
</div>

<script>
const dogNames = ["PABLO","LILI","JUGNIA","LEO","INDIA","KIMCHI","NINA","CARMELA","CUATRI","TB","NEO","BRISO","ZOZI","R&H"];
const extraDogs = ["CHUFI","LUPE","CUSCO"];
let rows = [];

let currentDate = new Date();
const dateBtn = document.getElementById('dateBtn');
const dateInput = document.getElementById('dateInput');
const dogButtonsDiv = document.getElementById('dogButtons');
const extrasDiv = document.getElementById('extrasButtons');
const tbody = document.getElementById('tableBody');
let dogButtons = [];
let extraButtons = [];

function formatDate(d){
  const dd = String(d.getDate()).padStart(2,'0');
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const yyyy = d.getFullYear();
  return `${dd}/${mm}/${yyyy}`;
}

function updateDateBtn(){
  dateBtn.textContent = formatDate(currentDate);
}

function resetDogButtons(){
  dogButtons.forEach(btn=>btn.classList.remove('active'));
  extraButtons.forEach(btn=>btn.classList.remove('active'));
}

function createDogButtons(){
  dogNames.forEach(name=>{
    const btn = document.createElement('button');
    btn.textContent = name;
    btn.addEventListener('click',()=>{
      const adding = !btn.classList.contains('active');
      btn.classList.toggle('active');
      updateDogPayment(name, adding);
    });
    dogButtonsDiv.appendChild(btn);
    dogButtons.push(btn);
  });
  extraDogs.forEach(name=>{
    const btn = document.createElement('button');
    btn.textContent = name;
    btn.addEventListener('click',()=>{
      const adding = !btn.classList.contains('active');
      btn.classList.toggle('active');
      updateDogPayment(name, adding);
    });
    extrasDiv.appendChild(btn);
    extraButtons.push(btn);
  });
}

function findRowByDate(dateStr){
  return rows.find(r=>r.Fecha===dateStr);
}

function updateDogPayment(dogName, add){
  const dateStr = formatDate(currentDate);
  let row = findRowByDate(dateStr);
  if(!row){
    row = {Fecha: dateStr, Total: 0};
    [...dogNames, ...extraDogs].forEach(d=>row[d]=0);
    rows.push(row);
  }
  if(add){
    row[dogName] += 10;
    row.Total += 10;
  }else{
    row.Total -= Math.min(10, row[dogName]);
    row[dogName] = Math.max(0, row[dogName]-10);
  }
  row.Total = Math.max(0, row.Total);
  buildTable();
}

function buildTable(){
  tbody.innerHTML='';
  rows.sort((a,b)=>new Date(a.Fecha.split('/').reverse().join('-')) - new Date(b.Fecha.split('/').reverse().join('-')));
  rows.forEach(r=>{
    const tr = document.createElement('tr');

    // Detect weekend
    const parts = r.Fecha.split('/');
    const rowDate = new Date(parts[2], parts[1]-1, parts[0]);
    if(rowDate.getDay() === 0 || rowDate.getDay() === 6){
      tr.classList.add('weekend');
    }

    const tdFecha = document.createElement('td'); tdFecha.textContent = r.Fecha; tr.appendChild(tdFecha);
    const tdTotal = document.createElement('td'); tdTotal.textContent = r.Total+' €'; tdTotal.classList.add('currency'); tr.appendChild(tdTotal);
    [...dogNames, ...extraDogs].forEach(d=>{
      const td = document.createElement('td');
      td.textContent = r[d]||'';
      td.classList.add('currency');
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
}

// Date input toggle
dateBtn.addEventListener('click',()=>{
  dateInput.valueAsDate = currentDate;
  dateInput.style.display = 'inline-block';
});
dateInput.addEventListener('change',(e)=>{
  currentDate = new Date(e.target.value);
  updateDateBtn();
  dateInput.style.display = 'none';
  resetDogButtons();
  buildTable();
});

// Prev/Next day buttons
document.getElementById('prevDay').addEventListener('click',()=>{
  currentDate.setDate(currentDate.getDate()-1);
  updateDateBtn();
  resetDogButtons();
  buildTable();
});
document.getElementById('nextDay').addEventListener('click',()=>{
  currentDate.setDate(currentDate.getDate()+1);
  updateDateBtn();
  resetDogButtons();
  buildTable();
});

updateDateBtn();
createDogButtons();
buildTable();
</script>
</body>
</html>
